<div class="container py-4">

  <!-- Header with Timer -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h4 class="fw-bold">ğŸ“ Online Test</h4>
    <div class="bg-light px-3 py-2 rounded shadow-sm">
      â±ï¸ Time Left: <span class="fw-bold text-danger">{{ formattedTime }}</span>
    </div>
  </div>

  <!-- Dynamic Question -->
  <div *ngIf="currentQuestion">
    <div class="card shadow-sm mb-4">
    <div class="card-body">
        <h5 class="card-title mb-3">
          Q{{ currentIndex + 1 }}. {{ currentQuestion.question }}
        </h5>
        <div *ngFor="let opt of currentQuestion.options; let i = index" class="form-check mb-2">
          <input
            class="form-check-input"
            type="radio"
            [name]="'q' + currentIndex"
            [id]="'q' + currentIndex + '_' + i"
            [value]="opt"
            [(ngModel)]="currentQuestion.selectAnswer"
            (change)="selectOption(opt)"
          />
          <label class="form-check-label" [for]="'q' + currentIndex + '_' + i">
            {{ 'ABCD'[i] || '' }}. {{ opt }}
          </label>
        </div>
      </div>
    </div>
  </div>
  

  <!-- Bottom Controls -->
  <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 mb-4">
    <div class="d-flex gap-2 flex-wrap">
      <button class="btn btn-outline-secondary" (click)="prevQuestion()" [disabled]="currentIndex === 0">â¬…ï¸ Previous</button>
      <button class="btn btn-outline-primary" (click)="nextQuestion()" [disabled]="currentIndex === questions.length - 1">â¡ï¸ Next</button>
    </div>
    <div class="d-flex gap-2">
      <button class="btn btn-warning" (click)="markForReview()">ğŸŸ¡ Mark for Review</button>
      <button class="btn btn-danger" (click)="clearAnswer()">ğŸ—‘ï¸ Clear Answer</button>
    </div>
  </div>

  <!-- Question Palette -->
  <div class="card p-3 shadow-sm mb-4">
    <h6 class="fw-bold mb-3">ğŸ“Œ Question Status</h6>
    <div class="d-flex flex-wrap gap-2">
      <span
        *ngFor="let q of questions; let i = index"
        class="badge"
        [ngClass]="{
          'bg-success': isAttempted(i),
          'bg-warning text-dark': isMarked(i),
          'bg-light text-dark border': !isAttempted(i) && !isMarked(i)
        }"
        (click)="goToQuestion(i)"
        style="cursor: pointer;"
      >
        {{ i + 1 }}
      </span>
    </div>
    <div class="mt-3 small text-muted">
      <span class="me-3"><span class="badge bg-success">&nbsp;</span> Attempted</span>
      <span class="me-3"><span class="badge bg-warning">&nbsp;</span> Marked</span>
      <span><span class="badge border">&nbsp;</span> Not Attempted</span>
    </div>
  </div>

  <!-- Submit Button -->
  <div class="text-center">
    <button class="btn btn-success btn-lg px-4" (click)="submitTest()">âœ… Submit Test</button>
  </div>
<!-- routerLink="/result-page" -->
</div>

<!-- Modal -->
<div class="modal fade" id="startTestModal" tabindex="-1" aria-labelledby="startTestLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="startTestLabel">Ready to End?</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center">
        Are you sure to End the Test?
      </div>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-success" (click)="onEndTest()">Yes</button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
      </div>
    </div>
  </div>
</div>
