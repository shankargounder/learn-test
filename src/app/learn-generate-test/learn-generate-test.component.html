<div class="container my-5">
  <!-- Back Button -->
  <div class="mb-4">
    <a routerLink="/student" class="btn btn-outline-secondary">
      â† Back to Student Dashboard
    </a>
  </div>

  <h2 class="text-center fw-bold mb-4">ğŸ“š Learn & Generate Tests</h2>
  <p class="text-center text-muted mb-4">
    Choose how you'd like to learn or generate a test.
  </p>

  <!-- Nav Tabs -->
  <ul class="nav nav-tabs justify-content-center mb-4" id="learnTab" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="topic-tab" data-bs-toggle="tab" data-bs-target="#topic" type="button" role="tab">
        ğŸ” Search Topic
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="image-tab" data-bs-toggle="tab" data-bs-target="#image" type="button" role="tab">
        ğŸ–¼ï¸ Upload Image
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="pdf-tab" data-bs-toggle="tab" data-bs-target="#pdf" type="button" role="tab">
        ğŸ“„ Upload PDF
      </button>
    </li>
  </ul>

  <!-- Tab Panes -->
  <div class="tab-content" id="learnTabContent">
    <!-- Topic Tab -->
    <div class="tab-pane fade show active" id="topic" role="tabpanel">
      <div class="card p-4 shadow mb-4">
        <h5 class="fw-bold mb-3">ğŸ” Search Any Topic to Learn</h5>
         <!-- Input and Ask AI Button in One Row -->
        <div class="d-flex gap-2 flex-wrap mb-3">
          <input type="text" class="form-control flex-grow-1" [(ngModel)]="query" placeholder="e.g. Algebra, Photosynthesis...">
          <button class="btn btn-outline-primary" (click)="askAI()">ğŸ¤– Ask AI</button>
        </div>
        <div class="mb-3" id="learnContent">
          <!-- Dynamic content preview -->
           <div class="mt-3 p-3 border rounded" *ngIf="reply">
              <strong>AI:</strong>
              <span *ngIf="isLoading">Thinking...</span>
              <span *ngIf="!isLoading">{{ reply }}</span>
          </div>
        </div>

        <!-- Difficulty Options -->
        <div class="mb-3">
          <label class="form-label fw-semibold">Select Difficulty</label>
          <div class="btn-group w-100" role="group">
            <input type="radio" class="btn-check" name="diff1" id="easy1">
            <label class="btn btn-outline-success" for="easy1">Easy</label>
            <input type="radio" class="btn-check" name="diff1" id="med1">
            <label class="btn btn-outline-warning" for="med1">Medium</label>
            <input type="radio" class="btn-check" name="diff1" id="hard1">
            <label class="btn btn-outline-danger" for="hard1">Hard</label>
            <input type="radio" class="btn-check" name="diff1" id="concept1">
            <label class="btn btn-outline-info" for="concept1">Concept</label>
            <input type="radio" class="btn-check" name="diff1" id="mix1" checked>
            <label class="btn btn-outline-secondary" for="mix1">Mix</label>
          </div>
        </div>

        <button class="btn btn-primary w-100" (click)="generateTest('content')">ğŸš€ Generate Test from Topic</button>
      </div>
    </div>
    <!-- routerLink="/online-test" -->

    <!-- Image Tab -->
    <div class="tab-pane fade" id="image" role="tabpanel">
      <div class="card p-4 shadow mb-4">
        <h5 class="fw-bold mb-3">ğŸ–¼ï¸ Upload an Image</h5>
        <input type="file" class="form-control mb-3" (change)="onFileSelected($event)" accept="image/*">

        <div class="mb-3">
          <label class="form-label fw-semibold">Select Difficulty</label>
          <div class="btn-group w-100" role="group">
            <input type="radio" class="btn-check" name="diff2" id="easy2">
            <label class="btn btn-outline-success" for="easy2">Easy</label>
            <input type="radio" class="btn-check" name="diff2" id="med2">
            <label class="btn btn-outline-warning" for="med2">Medium</label>
            <input type="radio" class="btn-check" name="diff2" id="hard2">
            <label class="btn btn-outline-danger" for="hard2">Hard</label>
            <input type="radio" class="btn-check" name="diff2" id="concept2">
            <label class="btn btn-outline-info" for="concept2">Concept</label>
            <input type="radio" class="btn-check" name="diff2" id="mix2" checked>
            <label class="btn btn-outline-secondary" for="mix2">Mix</label>
          </div>
        </div>

        <button class="btn btn-primary w-100" (click)="generateTest('image')">ğŸš€ Generate Test from Image</button>
      </div>
    </div>

    <!-- PDF Tab -->
    <div class="tab-pane fade" id="pdf" role="tabpanel">
      <div class="card p-4 shadow mb-4">
        <h5 class="fw-bold mb-3">ğŸ“„ Upload a PDF</h5>
        <input type="file" class="form-control mb-3" (change)="onFileSelected($event)" accept="application/pdf">

        <div class="mb-3">
          <label class="form-label fw-semibold">Select Difficulty</label>
          <div class="btn-group w-100" role="group">
            <input type="radio" class="btn-check" name="diff3" id="easy3">
            <label class="btn btn-outline-success" for="easy3">Easy</label>
            <input type="radio" class="btn-check" name="diff3" id="med3">
            <label class="btn btn-outline-warning" for="med3">Medium</label>
            <input type="radio" class="btn-check" name="diff3" id="hard3">
            <label class="btn btn-outline-danger" for="hard3">Hard</label>
            <input type="radio" class="btn-check" name="diff3" id="concept3">
            <label class="btn btn-outline-info" for="concept3">Concept</label>
            <input type="radio" class="btn-check" name="diff3" id="mix3" checked>
            <label class="btn btn-outline-secondary" for="mix3">Mix</label>
          </div>
        </div>

        <button class="btn btn-primary w-100" (click)="generateTest('file')">ğŸš€ Generate Test from PDF</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="startTestModal" tabindex="-1" aria-labelledby="startTestLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="startTestLabel">Ready to Start?</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center">
        Your test is generated. Are you ready to start the test?
      </div>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-success" (click)="onStartTest()">Yes</button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
      </div>
    </div>
  </div>
</div>

<div class="spinner-overlay" *ngIf="isLoading">
  <div class="spinner"></div>
</div>
